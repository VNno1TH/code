#include "bits/stdc++.h"
using namespace std;
#define ll long long
int main()
{
    int T;
    cin >> T;
    while (T--)
    {
        int N, M, K;
        cin >> N >> M >> K;
        
	vector<vector<ll>> prefix_hotel(N+1,vector<ll> (M+1));
	
	for(int i=1;i<=N;i++)
	{
		for(int j=1;j<=M;j++){
    		cin>>prefix_hotel[i][j];
            prefix_hotel[i][j]+=prefix_hotel[i-1][j]+prefix_hotel[i][j-1]-prefix_hotel[i-1][j-1];
		}
	}
	auto return_sum=[&](int a,int b,int A,int B)
    {
        return prefix_hotel[A][B] -prefix_hotel[a-1][B]-prefix_hotel[A][b-1]+prefix_hotel[a-1][b-1];
    };// return sum

    int best=-1;
    for(int i=0;i<N;i++)
    {
        for(int j=0;j<M;j++)
        {
            if(return_sum(i,j,i,j)==0)  continue;

            int lo=0;
            int hi=max(N,M);
            int valid=-1;

            while(lo<=hi)
            {
                int mid=(lo+hi)/2;
                int a=max(0,i-mid),A=min(N-1,i+mid);
                int b=max(0,j-mid),B=min(M-1,j+mid);
                if(return_sum(a+1,b+1,A+1,B+1)-1>=K)
                {
                    valid=mid;
                    hi=mid-1;
                }
                else{
                    lo=mid+1;
                }
            }
            if(valid!=-1){ best=best==-1 ?valid:min(best,valid); }
        }
         
    }
    cout<<best<<endl;
    }
}
